#!/bin/bash

echo "Running pre-commit hook..."

# Check for backend code formatting
if [ -d "backend" ]; then
  echo "Checking backend code formatting..."
  # For Java projects, you can add format validation with tools like checkstyle
  # Example: cd backend && ./mvnw checkstyle:check
fi

# Check for frontend code linting
if [ -d "frontend" ]; then
  echo "Checking frontend code linting..."
  # For Angular projects, you can add lint validation
  # Example: cd frontend && npm run lint
fi

# Check for sensitive data
echo "Checking for sensitive data patterns..."
if git diff --cached --name-only | xargs grep -l "API_KEY\|SECRET\|PASSWORD" > /dev/null; then
  echo "ERROR: Potential sensitive data detected in commit!"
  echo "Please remove API keys, secrets, or passwords before committing."
  exit 1
fi

# Check for large files
echo "Checking for large files..."
FILES=$(git diff --cached --name-only)
for FILE in $FILES; do
  SIZE=$(du -k "$FILE" | cut -f1)
  if [ "$SIZE" -gt 500 ]; then
    echo "ERROR: File $FILE is too large ($SIZE KB). Consider git-lfs for large files."
    exit 1
  fi
done

echo "Pre-commit checks passed!"
exit 0 